
<!DOCTYPE html>
<html >
<head>
<meta charset=UTF-8>
<title>404 - Thysbelon</title>
<meta property="og:title" content="404 - Thysbelon">
<meta name=viewport content=width=device-width,initial-scale=1.0>
<meta name="color-scheme" content="dark light">
<meta name=theme-color content=#ff4c60>
<link rel=stylesheet href=/css/BlogStylesheet.css>

<noscript><style>.jsonly{display:none}</style></noscript>
<link rel=icon type=image/x-icon href=/img/thysbelonicon.svg>
<meta name=robots content=noindex>

 

<script src=/js/hidelang.js></script>
 
<!-- to do: og:image property here. make a universal eleventyConfig function to fetch the first image of a post. -->
</head>
<body>
<header>
<a href="/">
<img id=blogtitle src=/img/ThysbelonTitle.svg alt=Thysbelon. width=1002 height=272><img src=/img/thysbelonicon.svg alt="Logo of a Hummingbird moth." width=280 height=280>
</a>
</header>
<nav><ul > 

</ul></nav>
<main> 
<section>
	<!-- To do: remove reliance on posts.json and pull a list of posts from the sitemap instead. -->
	<h1>404:<span lang=ja>ページが見つけなかった</span>　<span lang=en>Page not found</span></h1>
	<noscript><p lang=en>Turn on Javascript to see a list of suggestions.</p><p lang=ja>発案のリストを見るためにJavaScriptをオンにしてください。</p></noscript>
	<p class=jsonly><span lang=en>Loading suggestions...</span><span lang=ja>発案をロードしている…</span></p>
	<!--<img class="websitecolor fri" src=/workingmoth.webp> replace this with a magnifying glass moth-->
	<p lang=en>You can also use the search bar to search for pages on this website by adding "site:thysbelon.github.io/" to the beginning of your search.
	<p lang=ja>あなたは検索の始めに「site:thysbelon.github.io/」を足すのでウェブサイトでページを検索するために検索窓を使える。
</section>
<script>
async function getAndParseSitemap() {
	//fetch("/sitemap.xml")
	let response = await fetch("/sitemap.xml")
	//.then((response) => response.text())
	let text = await response.text()
	//.then((text) => {
	const parser = new DOMParser();
	const doc = parser.parseFromString(text, "text/xml");
	console.log(doc.documentElement.nodeName);
	console.log('getAndParseSitemap is finished');
	return doc
	//});
}

function getURLarrayFromSitemap(doc) {
	var locArray=doc.getElementsByTagName('loc')
	const URLarray=Array.from(locArray).map(loc => loc.innerHTML)
	console.log('URLarray: '+URLarray)
	return URLarray
}

(async function(){
	console.log("navigator.language=="+navigator.language)
	if (navigator.language=="ja"){
		console.log("japanese language detected")
		var suggestor=new Worker('/404-jp.js')
	} else {
		console.log("other language detected")
		var suggestor=new Worker('/404-2.js')
	}
	const doc=await getAndParseSitemap()
	console.log('this should not print until sitemap is finished')
	suggestor.postMessage({pathname: window.location.pathname, URLarray: getURLarrayFromSitemap(doc)})
	console.log('message posted to worker')
	if (navigator.language=="ja"){var suggestMessage="このリストが手伝うかもしれません。"} else {var suggestMessage="Maybe this list will help? (make sure there are no typos in the url!)"}
	suggestor.addEventListener('message', function(e){document.querySelector("p.jsonly").outerHTML="<p>"+suggestMessage+"</p>"+e.data; suggestor.terminate()}, {once:true})
})()
</script>
</main>

<footer>Header font from <a href=http://velvetyne.fr/fonts/compagnon/ target=_blank>Velvetyne</a></footer>
</body></html>
